package cn.org.gdicpa.web.service.education;import java.io.UnsupportedEncodingException;import java.security.MessageDigest;import java.security.NoSuchAlgorithmException;/** * MD5加密算法 */public class Md5 {	/**	 * Used building output as Hex	 */	private static final char[] DIGITS = { '0', '1', '2', '3', '4', '5', '6',			'7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };	/**	 * 对字符串进行MD5加密	 * 	 * @param text	 *            明文	 * 	 * @return 密文	 */	public static String md5(String text) {		MessageDigest msgDigest = null;		try {			msgDigest = MessageDigest.getInstance("MD5");		} catch (NoSuchAlgorithmException e) {			return "System does not support MD5 algorithm.";		}		try {			msgDigest.update(text.getBytes("utf-8")); //or GBK etc.		} catch (UnsupportedEncodingException e) {			return "System does not support your  EncodingException.";		}		byte[] bytes = msgDigest.digest();		String md5Str = new String(encodeHex(bytes));		return md5Str;	}	public static String md5gbk(String text) {		MessageDigest msgDigest = null;		try {			msgDigest = MessageDigest.getInstance("MD5");		} catch (NoSuchAlgorithmException e) {			return "System does not support MD5 algorithm.";		}		try {			msgDigest.update(text.getBytes("GBK")); //or GBK etc.		} catch (UnsupportedEncodingException e) {			return "System does not support your  EncodingException.";		}		byte[] bytes = msgDigest.digest();		String md5Str = new String(encodeHex(bytes));		return md5Str;	}	public static char[] encodeHex(byte[] data) {		int l = data.length;		char[] out = new char[l << 1];		// two characters form the hex value.		for (int i = 0, j = 0; i < l; i++) {			out[j++] = DIGITS[(0xF0 & data[i]) >>> 4];			out[j++] = DIGITS[0x0F & data[i]];		}		return out;	}		public static void main(String[] args) {//		System.out.println(md5("362135197701230046").toUpperCase());//		System.out.println(md5("362135").toUpperCase());//		System.out.println(md5("gdicpagdicpa").toUpperCase());//		System.out.println(md5("matech3").toUpperCase());				//271cd0842e02b4436a9df2dd98127133				/*name=姓名&certno=证书号&sign=校验码&signtime=2014-05-29 HH：mm：ss		校验码规则：		md5(姓名+证书号+私钥+YYYY-MM-DD HH：mm：ss)		私钥为：SCicpa#822*/				/**		 * 姓名:网校测试账号		 * 证书号:360570		 * 私钥:SCicpa#822		 * 时间：2014-06-09 15:12:00		 */		String p = "网校测试账号"+"360570"+"SCicpa#822"+"2014-06-09 15:12:00";		System.out.println(Md5.md5(p));//f3e2a2460868e1ecdfa811e2397de8b7				System.out.println(Md5.md5("周海燕2120110041SCicpa#9112014-06-12 16:08:02"));//c71b45689d2ce6c624f8697f41c16899		System.out.println(Md5.md5("周海燕2120110041SCicpa#8222014-06-12 14:48:24"));//32350c3c73cb77f869d400428b3a56c5	}}